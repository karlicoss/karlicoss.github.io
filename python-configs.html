<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Icon made by Twitter -->
        <!-- https://twemoji.twitter.com/content/twemoji-twitter/en.html -->
        <link rel="icon" href="./robot-face.png">
        <link rel="apple-touch-icon" href="./robot-face.png">

        <meta name="generator" content="hakyll">
        <meta name="language" content="English">
        
        <meta name="keywords" content="python mypy">
        
        <!-- TODO concat with keywords tags; also need to make comma separated? -->

        <title>Python is a decent config file format | Mildly entertaining·µù</title>

        <link href="https://fonts.googleapis.com/css?family=Source+Serif+Pro" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="./css/default.css?v=3" />
        <!-- TODO make conditional?? -->
        <link rel="stylesheet" href="./css/posts-list.css" /> 
        <link rel="stylesheet" href="./css/links.css?v=4" />

        
    </head>
    <body>
        <header>
            <nav>
                <span class="nav-left">
                    <a class="fat" href="./">Home</a>
                    <!-- TODO eh, not sure if this symbol is good for that... -->
                    ¬∑
                    <a class="fat" href="./ideas.html">Ideas</a>
                    ¬∑
                    <a class="fat" href="./notes.html">Notes</a>
                    ¬∑
                    <a class="fat" href="./tags.html">Tags</a>
                </span>
                <span class="nav-right">
                    <a class="fat" href="./feed.html">Feed</a>
                    ¬∑
                    <a class="fat" href="./site.html">Site</a>
                    ¬∑
                    <a class="fat" href="./me.html">Me</a>
                </span>
            </nav>
        </header>

        <main>
            

<!-- <link rel="stylesheet" href="/css/org.css" /> -->

<link rel="stylesheet" href="./css/htmlize.css" />
<link rel="stylesheet" href="./css/org-default.css" />

<link rel="stylesheet" href="./css/org-extra.css?v=3" />



<article>
    
    <div>THIS IS A DRAFT! It will appear on the main page once finished!</div>
    
    <section class="post-title">
    <h1>Python is a decent config file format</h1>
    <div class="summary"></h2>
    </section>
    <!-- are sections appropriate for that? -->

    <section class="content">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org0000001">1. <span class="todo TODO">TODO</span> Integrate</a>
<ul>
<li><a href="#org0000000"><span class="todo TODO">TODO</span> <span class="timestamp-wrapper"><span class="timestamp">[2019-12-04 21:00]</span></span> someone surely must have written about it? link perhaps?</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
<b>Draft stage</b>: mostly ready in terms of what I want to say and structure, writing needs to be improved.
</p>
<p>
TODO don't really like the name, do smth different
</p>
<p>
I've decided to write more about some TODO I like Python, so here's we go.
</p>
<p>
(Unpopular?) opinion: Python is a perfect, if not best language for writing config files.
</p>
<p>
Why <b>most</b> config files formats suck:
</p>
<ul class="org-ul">
<li>don't have comments (e.g. JSON) TODO apparently even deliberately???</li>
<li>can't be included without extra code that has to be implemented by the porgrammer, and there is no standard for that</li>
<li><p>
can't have <b>any</b> logic
</p>
<p>
That would be considered as a positive by many, but I would argue that when you can't define temporary variables, functions, substitute strings or concatenate lists, it's fucked up. This is a <a href="https://en.wikipedia.org/wiki/Total_functional_programming">somewhat solved</a> problem in computer science, and you can totally have resonable subset of language.
</p></li>
<li>can't be validated; except for syntax, by your text editor. Kind of a consequence of not having logic.</li>
<li>YAML TODO just add one of links criticizing it, there is enough of it on the internet already
1.1 vs 1.2 <a href="https://yaml.org">https://yaml.org</a></li>
</ul>
<p>
So what happens? Often configs end up generated by real programming languages anyway.
</p>
<ul class="org-ul">
<li>you use real programming language to filter out your custom comment syntax</li>
<li>you use real programming language to merge the configs</li>
<li>you use real programming language to 'evaluate' the config (often essentially reimplementing simple functional language)</li>
<li>you use real programming language to validate (and end up with mediocre error messages as a result)</li>
</ul>
<p>
None of these things are pleasant and they all distract you from your objective.
You kind of see where I'm coming with this.
I suggest that <b>Python</b> is extremely well fit for writing configs.
TODO (even when you're writing a c++ program??)
</p>
<p>
How using Python files solves these issues?
</p>
<ul class="org-ul">
<li>comments: duh</li>
<li>includes: use Python means of importing modules</li>
<li><p>
logic
</p>
<p>
You have all Python syntax (and libraries) at your disposal.
Of course, one could go crazy, but I'd rather accept potential for abusing rather than being restricted.
</p></li>
<li><p>
validation
</p>
<p>
You can easily validate at the time of module loading. You have all the existing Python tools at your disposal (pylint/mypy)
</p></li>
</ul>
<p>
TODO interoperabiliby: one common argument is that if your program ever migrates from Python (e.g. you rewritten it in C++ to speed up),
you're doomed.
Good point, but I don't buy it. 
Python is present in most modern OS distributions
I suggest that it's at least <b>not worse</b> than using something like json in the first place: it's trivial to emit a json file from your python config to consume by C++ code.
</p>
<p>
TODO performance: parsing vs evaluation?
</p>
<p>
Extra benefits 
</p>
<ul class="org-ul">
<li>using python's data classes and functions and generators ‚Äì you can construct a small DSL for your configs
datatypes like datetimes, currencies, etc</li>
<li>using mypy typing annotations ‚Äì serves as self-documentation and validation at the same time</li>
<li>TODO e.g. config with secrets ‚Äì can keep login code close?</li>
</ul>
<p>
What's the worst that could happen?
</p>
<p>
Security? E.g. attacker injects arbitrary code.
TODO wow! <a href="https://www.arp242.net/yaml-config.html#insecure-by-default">https://www.arp242.net/yaml-config.html#insecure-by-default</a>
</p>
<p>
Yaml syntax: sucks <a href="https://www.arp242.net/yaml-config.html#surprising-behaviour">https://www.arp242.net/yaml-config.html#surprising-behaviour</a>
</p>
<p>
or lower privileged users change config and execute code as higher priveleged (kinda questionable setup anyway)
Sandboxing? Actually research it, perhaps it's possible.
Infinite loops etc?
</p>
<p>
TODO some config files end up being Turing complete anyway (e.g. mail filters?)
</p>
<p>
If you're truly paranoid, it's possible to lint it before loading or perhaps sandbox.
(disclaimer: I never actually tried it, so perhaps it's harder than it seems. obviously, halting problem kicks in etc)
TODO Skylark/Bazel is a good example of that approach.
</p>
<p>
Python ecosystem is a good example of how fucked up are config files.
</p>
<p>
E.g. you have to write code in <samp class="inline">setup.py</samp> when you can't force <samp class="inline">setup.cfg</samp> do what you want. Trivial example: duplicate dependencies.
Although to be fair, at least they offer hybrid approach, which means that one can use it the way they are comfortable with.
</p>
<p>
TODO examples of systems that use python for configuration files?
</p>
<div class="outline-2" id="outline-container-org0000001">
<h2 id="org0000001"><a class="headerlink" href="#org0000001">¬∂</a><span class="section-number-2">1</span> <span class="todo TODO">TODO</span> Integrate</h2>
<div class="outline-text-2" id="text-1">
</div>
<div class="outline-3" id="outline-container-org0000000">
<h3 id="org0000000"><a class="headerlink" href="#org0000000">¬∂</a><span class="todo TODO">TODO</span> <span class="timestamp-wrapper"><span class="timestamp">[2019-12-04 21:00]</span></span> someone surely must have written about it? link perhaps?</h3>
<div class="outline-text-3" id="text-org0000000">
<p>
<a href="https://www.arp242.net/json-config.html">https://www.arp242.net/json-config.html</a>
</p>
</div>
</div>
</div>

    </section>

    
    <section class="footer">
        <div class="post-tags"><a class="post-tag" href="./tags.html#python mypy">#python mypy</a></div>
        <!-- TODO post-date? -->
        <div class="date">04 December 2019</div>
    </section>
    

    

    <section class="comments">
    <script data-isso="https://beepb00p.xyz/comments/" data-isso-reply-to-self="true" src="https://beepb00p.xyz/comments/js/embed.min.js">
</script>

<section id="isso-thread" data-isso-id="isso_python_configs"></section>

    </section>

</article>

        </main>

        <!-- TODO hmm maybe display something in a footer, so it's clear it's end of content... -->
        
        <footer>
            <span style="float:left">
            <a href="https://twitter.com/karlicoss">üê¶ me @twitter</a>
            ¬∑
            <a href="https://github.com/karlicoss">üíª me @github</a>
            </span>

            <a href="http://creativecommons.org/licenses/by/4.0">CC BY 4.0</a>
            
            
        </footer>
    </body>
</html>
